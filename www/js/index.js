function J(b){function q(B){B.stopPropagation();const{offsetX:N,offsetY:R}=B,$=Math.min(Math.floor(N/b.ui.cellSize),8),T=Math.min(Math.floor(R/b.ui.cellSize),8),Y=b.getSelectedCell();if(Y===null||Y[0]!==$||Y[1]!==T)b.setSelectedCell([$,T]),b.refreshGrid()}function A(B){if(B.stopPropagation(),b.getSelectedCell()!==null)b.setSelectedCell(null),b.refreshGrid()}function L(B){if(B.stopPropagation(),B.key>="1"&&B.key<="9"&&b.getSelectedCell()!==null)b.toggle(parseInt(B.key))}b.canvas.addEventListener("mousemove",q),b.canvas.addEventListener("mouseout",A),document.onkeyup=L}class O{b;q;static _uis=new WeakMap;static bgColor="#DDD";static thinLineColor="#AAA";static boldLineColor="#000";static impactedColor="#eec";static selectedColor="#ff6";static get(b){if(O._uis.has(b))return O._uis.get(b);const q=b.getContext("2d");if(q===null)return!1;const A=new O(b,q);return O._uis.set(b,A),A}_cellSize;constructor(b,q){this._canvas=b;this._ctx=q;this._cellSize=Math.round(Math.min(b.width,b.height)/9)}get width(){return this._canvas.width}get height(){return this._canvas.height}get cellSize(){return this._cellSize}clearCanvas(){return this._ctx.fillStyle=O.bgColor,this._ctx.fillRect(0,0,this.width,this.height),this}drawCell(b,q,A=this._cellSize,L=O.thinLineColor,B){const N=b*A,R=q*A;if(B)this._ctx.fillStyle=B,this._ctx.fillRect(N+1,R+1,A-2,A-2);return this._ctx.strokeStyle=L,this._ctx.strokeRect(N,R,A,A),this}drawRow(b,q){for(let A=0;A<9;A++)this.drawCell(A,b,this._cellSize,O.thinLineColor,q);return this}drawColumn(b,q){for(let A=0;A<9;A++)this.drawCell(b,A,this._cellSize,O.thinLineColor,q);return this}drawGroup(b,q,A){this.drawCell(b,q,this._cellSize*3,O.boldLineColor,A);for(let L=0;L<3;L++)for(let B=0;B<3;B++)this.drawCell(b*3+B,q*3+L,this._cellSize,O.thinLineColor);return this}drawCellValue(b,q,A){this._ctx.fillStyle="#000",this._ctx.font="bold 60px Arial",this._ctx.textBaseline="middle",this._ctx.textAlign="center";const L=b*this._cellSize+Math.floor(this._cellSize*0.5),B=q*this._cellSize+Math.floor(this._cellSize*0.575);return this._ctx.fillText(A.toString(),L,B),this}drawCellDomain(b,q,A){this._ctx.fillStyle="#000",this._ctx.font="16px Arial",this._ctx.textBaseline="top",this._ctx.textAlign="start";const L=Math.max(this._cellSize-2,Math.floor(this._cellSize*0.8)),B=Math.floor(L/3),N=Math.max(1,Math.floor(this._cellSize*0.1)),R=b*this._cellSize+N,$=q*this._cellSize+N;for(let T=1;T<=9;T++){const Y=A.includes(T)?T:null,F=(T-1)%3,H=Math.floor((T-1)/3),h=R+B*F,E=$+B*H;this._ctx.fillText(Y!==null?Y.toString():"",h,E)}return this}drawEmptyGrid(){this.clearCanvas();for(let b=0;b<3;b++)for(let q=0;q<3;q++)this.drawGroup(q,b);return this}colorizeSelectedStuff(b){if(b===null)return this;const q=[Math.floor(b[0]/3),Math.floor(b[1]/3)];return this.drawRow(b[1],O.impactedColor).drawColumn(b[0],O.impactedColor).drawGroup(q[0],q[1],O.impactedColor).drawCell(b[0],b[1],this._cellSize,O.thinLineColor,O.selectedColor),this}}function y(){const b=new WebSocket(`ws://${location.host}`);b.onopen=()=>setInterval(()=>b.send("ping"),5000),b.onmessage=(q)=>{if(q.data!=="Well received")console.log(q.data);if(q.data==="reload")location.reload()}}var G=function(b,q){const A=b.indexOf(q);if(A!==-1)b.splice(A,1);return b},w=function(b,q){if(b.indexOf(q)===-1)b.push(q);return b};var f=function(b){const q=document.getElementById(b);if(q===null)return console.error("Cannot get the given Canvas 2D rendering context"),!1;const A=O.get(q);if(!A)return!1;const L=[],B=[];for(let N=0;N<9;N++){L.push([]),B.push([]);for(let R=0;R<9;R++)L[N].push([1,2,3,4,5,6,7,8,9]),B[N].push(null)}return{canvas:q,ui:A,cellDomains:L,cellValues:B}},D=function(b){const{canvas:q,ui:A,cellDomains:L,cellValues:B}=b;let N=null;function R(E,K){if(B[K][E]!==null)A.drawCellValue(E,K,B[K][E]);else A.drawCellDomain(E,K,L[K][E])}function $(){for(let E=0;E<9;E++)for(let K=0;K<9;K++)R(K,E)}function T(E,K,Q){const W=L[K][E];G(W,Q)}function Y(E,K,Q){const W=L[K][E];w(W,Q)}function F(E,K,Q,W){const Z=W?T:Y;for(let X=0;X<9;X++){if(X!==E)Z(X,K,Q);if(X!==K)Z(E,X,Q)}const x=Math.floor(E/3),z=Math.floor(K/3);for(let X=0;X<3;X++)for(let P=0;P<3;P++){const M=x*3+P,_=z*3+X;if(M!==E&&_!==K)Z(M,_,Q)}}function H(E){const K=N[0],Q=N[1];if(B[Q][K]===null){if(L[Q][K].includes(E))B[Q][K]=E,F(K,Q,E,!0),h()}else if(B[Q][K]===E){B[Q][K]=null,F(K,Q,E,!1);for(let W=0;W<9;W++)for(let Z=0;Z<9;Z++)if(B[W][Z]===E)F(Z,W,E,!0);h()}}function h(){A.drawEmptyGrid().colorizeSelectedStuff(N),$()}J({canvas:q,ui:A,refreshGrid:h,toggle:H,getSelectedCell:()=>N,setSelectedCell:(E)=>N=E}),y(),h()},g=f("sudokuCanvas");if(g)D(g);
